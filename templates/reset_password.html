<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Restablecer contraseña</title>
    <link rel="stylesheet" href="/static/css/reset_password.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="circulo"><img src="/static/circulo.png" alt=""></div>
            <h1 class="title-he">IRIS</h1>
        </div>
    </header>
    <div class="page-container">
        <div class="reset-container">
            <div class="login-container">
                <div class="form-panel active">
                    <h2 style="text-align:center;">Restablecer contraseña</h2>
                    {% if error %}
                        <div class="error-message" style="text-align:center;">{{ error }}</div>
                    {% endif %}
                    <form method="POST" autocomplete="off">
                        <div class="password-field">
                            <input type="password" id="new_password" name="new_password" placeholder="Nueva contraseña" required>
                            <span class="toggle-password" onclick="togglePassword('new_password', this)" aria-label="Mostrar/Ocultar contraseña">
                                <!-- Ojo abierto SVG -->
                                <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" viewBox="0 0 24 24">
                                    <path stroke="#888" stroke-width="2" d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/>
                                    <circle cx="12" cy="12" r="3" stroke="#888" stroke-width="2"/>
                                </svg>
                                <!-- Ojo cerrado SVG (tachado), oculto por defecto -->
                                <svg class="eye-icon eye-off" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" viewBox="0 0 24 24" style="display:none;">
                                    <path stroke="#888" stroke-width="2" d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/>
                                    <circle cx="12" cy="12" r="3" stroke="#888" stroke-width="2"/>
                                    <line x1="4" y1="20" x2="20" y2="4" stroke="#888" stroke-width="2"/>
                                </svg>
                            </span>
                        </div>
                        <div id="passwordHelp" style="color:red; display:none; font-size:10px;">
                            La contraseña debe tener al menos 8 caracteres, una letra mayúscula, un número y un símbolo.
                        </div>
                        <button type="submit" style="width:100%;margin-top:18px;">Cambiar contraseña</button>
                    </form>
                </div>
            </div>
        </div>
        <script src="/static/js/login.js"></script>
        <script>
        // Validación en tiempo real para la nueva contraseña
        document.getElementById("new_password").addEventListener("input", function() {
            const password = this.value;
            const helpDiv = document.getElementById("passwordHelp");
            const regex = /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*]).{8,}$/;
            if (!regex.test(password)) {
                helpDiv.style.display = "block";
            } else {
                helpDiv.style.display = "none";
            }
        });
        </script>
    </body>
    </html>